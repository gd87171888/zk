<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>东莞中考分析工具</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #4facfe;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #4facfe;
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .result {
            margin-top: 30px;
            padding: 25px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            display: none;
        }

        .result.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .score-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .score-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .score-card h3 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .score-card .value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .school-recommendations {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .school-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .school-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
        }

        .school-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }

        .school-card h4 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.25em;
            font-weight: 600;
        }

        .school-card .probability {
            font-size: 0.95em;
            font-weight: 600;
            margin-bottom: 12px;
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
            text-align: center;
            min-width: 100px;
        }

        .probability.high { 
            color: #fff;
            background: linear-gradient(135deg, #28a745, #20c997);
        }
        .probability.medium { 
            color: #fff;
            background: linear-gradient(135deg, #ffc107, #fd7e14);
        }
        .probability.low { 
            color: #fff;
            background: linear-gradient(135deg, #dc3545, #e83e8c);
        }

        .school-info {
            margin-top: 15px;
        }

        .school-info p {
            margin-bottom: 8px;
            font-size: 0.9em;
            color: #6c757d;
        }

        .school-info strong {
            color: #495057;
        }

        .school-level {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 500;
            margin-left: 8px;
        }

        .level-顶尖 {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .level-重点 {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .level-优质 {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .level-普通 {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .data-table th, .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .data-table th {
            background: #4facfe;
            color: white;
            font-weight: bold;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .tips {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .tips h4 {
            color: #0066cc;
            margin-bottom: 10px;
        }

        .tips ul {
            margin-left: 20px;
        }

        .tips li {
            margin-bottom: 8px;
            color: #333;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #e9ecef;
            margin-top: 40px;
        }

        .footer p {
            margin: 5px 0;
            color: #6c757d;
            font-size: 0.9em;
        }

        .footer .brand {
            font-weight: 600;
            color: #4facfe;
        }

        .footer .year {
            font-weight: 500;
            color: #495057;
        }

        .footer .disclaimer {
            font-size: 0.8em;
            color: #868e96;
            margin-top: 10px;
        }

        /* 移动端优化 */
        @media (max-width: 768px) {
            body { padding: 8px; }
            .header { padding: 20px 15px; }
            .header h1 { font-size: 1.8em; margin-bottom: 8px; }
            .header p { font-size: 0.95em; line-height: 1.4; }
            .main-content { padding: 15px; }
            .section { padding: 18px; margin-bottom: 20px; }
            .section h2 { font-size: 1.4em; margin-bottom: 15px; }
            .input-group { margin-bottom: 15px; }
            .input-group label { font-size: 0.95em; margin-bottom: 6px; }
            .input-group input, .input-group select { padding: 10px; font-size: 16px; border-radius: 6px; }
            .btn { width: 100%; padding: 12px; font-size: 16px; margin-top: 10px; }
            .score-analysis { grid-template-columns: 1fr; gap: 12px; }
            .score-card { padding: 15px; text-align: center; }
            .score-card h3 { font-size: 1em; margin-bottom: 8px; }
            .score-card .value { font-size: 1.6em; }
            .school-recommendations { grid-template-columns: 1fr; gap: 10px; }
            .school-card { padding: 12px; }
            .school-card h4 { font-size: 1.05em; margin-bottom: 10px; }
            .probability { font-size: 0.85em; padding: 5px 10px; margin-bottom: 8px; }
            .school-info p { font-size: 0.85em; margin-bottom: 6px; }
            .data-table { font-size: 0.8em; overflow-x: auto; display: block; white-space: nowrap; }
            .data-table th, .data-table td { padding: 6px 4px; min-width: 60px; }
            .tips { padding: 12px; font-size: 0.9em; }
            .tips h4 { font-size: 1.1em; }
            .footer { padding: 15px 10px; }
            div[style*="grid-template-columns:1fr 1fr 1fr"] { display: block !important; }
            div[style*="grid-template-columns:1fr 1fr 1fr"] > div { margin-bottom: 15px !important; }
            div[style*="grid-template-columns:1fr 1fr"] { display: block !important; }
            div[style*="grid-template-columns:1fr 1fr"] > div { margin-bottom: 15px !important; }
        }

        @media (max-width: 480px) {
            body { padding: 5px; }
            .header { padding: 15px 10px; }
            .header h1 { font-size: 1.6em; line-height: 1.2; }
            .header p { font-size: 0.85em; }
            .main-content { padding: 10px; }
            .section { padding: 12px; margin-bottom: 15px; }
            .section h2 { font-size: 1.25em; }
            .input-group input, .input-group select { padding: 8px; font-size: 16px; }
            .btn { padding: 10px; font-size: 15px; }
            .score-card { padding: 12px; }
            .score-card .value { font-size: 1.4em; }
            .school-card { padding: 10px; }
            .school-card h4 { font-size: 1em; }
            .probability { font-size: 0.8em !important; padding: 4px 8px !important; min-width: 70px !important; }
            .school-info p { font-size: 0.8em; }
            .data-table { font-size: 0.7em; }
            .data-table th, .data-table td { padding: 4px 2px; min-width: 50px; }
            .tips { padding: 10px; font-size: 0.85em; }
            .tips h4 { font-size: 1em; }
            .tips ul { margin-left: 15px; }
            .footer { padding: 10px; font-size: 0.8em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎓 东莞中考分析工具</h1>
            <p>2025年十一大校扩容版 - 基于最新政策的智能升学分析系统</p>
        </div>

        <div class="main-content">
            <div class="section">
                <h2>📊 成绩录入</h2>
                <div class="input-group">
                    <label for="grade">年级:</label>
                    <select id="grade">
                        <option value="九年级">九年级</option>
                        </select>
                </div>
                <div class="input-group">
                    <label for="semester">学期:</label>
                    <select id="semester">
                        <option value="第二学期">第二学期（下学期）</option>
                        <option value="第一学期">第一学期（上学期）</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="exam">考试类型:</label>
                    <select id="exam">
                        <option value="中考">中考</option>
                        <option value="三模">三模</option>
                        <option value="二模">二模</option>
                        <option value="一模">一模</option>
                    </select>
                </div>
                 <div class="input-group">
                    <label for="juniorHighSchool">初中学校 (可选):</label>
                    <select id="juniorHighSchool" onchange="populateHujiGraduates()">
                        <option value="">-- 请选择您的初中学校 --</option>
                        </select>
                </div>
                <div class="input-group">
                    <label for="hujiGraduatesInput">本校户籍毕业生人数 (若上方未选或需手动调整):</label>
                    <input type="number" id="hujiGraduatesInput" placeholder="请输入本校户籍毕业生人数">
                </div>
                <div class="input-group">
                    <label for="score">总分:</label>
                    <input type="number" id="score" placeholder="请输入总分" min="0" max="800">
                </div>
                <div class="input-group">
                    <label for="totalScore">满分:</label>
                    <input type="number" id="totalScore" placeholder="请输入满分" value="800">
                </div>
                <button class="btn" onclick="analyzeScore()">🔍 开始分析</button>
            </div>

            <div id="analysisResult" class="result">
                <div class="section">
                    <h2>📈 成绩分析结果</h2>
                    <div class="score-analysis">
                        <div class="score-card">
                            <h3>得分率</h3>
                            <div class="value" id="scoreRate">-</div>
                            <div>当前水平</div>
                        </div>
                        <div class="score-card">
                            <h3>同比进步</h3>
                            <div class="value" id="progress">-</div>
                            <div>相比历史</div>
                        </div>
                        <div class="score-card">
                            <h3>推荐学校</h3>
                            <div class="value" id="recommendCount">-</div>
                            <div>所学校</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>🏫 十一大校推荐分析</h2>
                    <p>根据您的成绩水平，为您推荐最适合的学校（含2025年新增三校）：</p>
                    <div class="policy-notice" style="background:#e8f5e8;border-left:4px solid #27ae60;padding:10px;margin:10px 0;border-radius:5px;">
                        <strong>🆕 2025年政策变化：</strong>
                        <ul style="margin:5px 0;padding-left:20px;">
                            <li>新增石龙中学、万江中学、常平中学为十一大校</li>
                            <li>名额分配比例50%，户籍生可降分，传统八校20分，新增三校30分录取</li>
                            <li>新增三校竞争压力相对较小，录取机会增加</li>
                            <li><strong>招生规模扩大：</strong>普高招生54907人，公办普高33820人（增加2160人）</li>
                            <li><strong>随迁子女机会增加：</strong>公办普高随迁子女招生5000人（增加200人）</li>
                            <li><strong>新增学校：</strong>东莞市第十二高级中学2025年9月开学，招生1100人</li>
                        </ul>
                    </div>
                    <div class="school-recommendations" id="schoolRecommendations">
                        </div>
                </div>

                <div class="section">
                    <h2>🎯 名额分配策略分析</h2>
                    <div class="quota-analysis" id="quotaAnalysis">
                        </div>
                </div>
                 <div class="section" id="timelinePlanningSection">
                    </div>


                <div class="section">
                    <h2>📝 志愿填报规则详解</h2>
                    <div style="background:#f8f9fa;padding:15px;border-radius:8px;margin:10px 0;">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
                            <div style="background:white;padding:15px;border-radius:8px;border-left:4px solid #8e44ad;">
                                <h4 style="color:#8e44ad;margin-bottom:10px;">🏆 十一大校志愿级差</h4>
                                <ul style="margin:0;padding-left:20px;">
                                    <li><strong>第一志愿：</strong>正常分数线</li>
                                    <li><strong>第二志愿：</strong>分数线+15分</li>
                                    <li><strong>名额分配：</strong>仅限第一志愿</li>
                                    <li><strong>降分幅度：</strong>传统八校20分，新增三校30分</li>
                                </ul>
                            </div>
                            <div style="background:white;padding:15px;border-radius:8px;border-left:4px solid #3498db;">
                                <h4 style="color:#3498db;margin-bottom:10px;">🎯 其他普高志愿级差</h4>
                                <ul style="margin:0;padding-left:20px;">
                                    <li><strong>第一志愿：</strong>正常分数线</li>
                                    <li><strong>第二志愿：</strong>分数线+5分</li>
                                    <li><strong>第三志愿：</strong>分数线+10分 (前一志愿+5)</li>
                                    <li><strong>第四志愿：</strong>分数线+15分 (前一志愿+5)</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="background:#fff3cd;border-left:4px solid #ffc107;padding:15px;border-radius:5px;margin:15px 0;">
                            <h4 style="color:#856404;margin-bottom:10px;">💡 填报策略建议</h4>
                            <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px;">
                                <div>
                                    <h5 style="color:#856404;margin-bottom:8px;">高分段考生(700分+)</h5>
                                    <ul style="margin:0;padding-left:15px;color:#856404;font-size:0.9em;">
                                        <li>第一志愿：冲刺顶尖校</li>
                                        <li>第二志愿：重点校保底</li>
                                        <li>关注名额分配机会</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 style="color:#856404;margin-bottom:8px;">中分段考生(600-700分)</h5>
                                    <ul style="margin:0;padding-left:15px;color:#856404;font-size:0.9em;">
                                        <li>第一志愿：新增三校</li>
                                        <li>第二志愿：镇街重点</li>
                                        <li>利用30分降分优势</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 style="color:#856404;margin-bottom:8px;">临界考生(530-600分)</h5>
                                    <ul style="margin:0;padding-left:15px;color:#856404;font-size:0.9em;">
                                        <li>第一志愿：万江/常平</li>
                                        <li>第二志愿：民办优质</li>
                                        <li>第三志愿：综合高中</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background:#d1ecf1;border-left:4px solid #17a2b8;padding:15px;border-radius:5px;">
                            <h4 style="color:#0c5460;margin-bottom:10px;">⚠️ 重要提醒</h4>
                            <ul style="margin:0;padding-left:20px;color:#0c5460;">
                                <li><strong>名额分配仅限十一大校：</strong>其他普通高中不参与名额分配政策</li>
                                <li><strong>避免分数线相近：</strong>连续志愿间建议间隔10分以上</li>
                                <li><strong>关注补录机会：</strong>第一批次未录取可参与补录，需达普高控制线530分</li>
                                <li><strong>民办校无级差：</strong>民办高中各志愿无分数级差限制</li>
                                <li><strong>末位同分规则：</strong>依次按"语数英总分→道法+物理+历史+化学总分"排序</li>
                                <li><strong>语数英要求：</strong>顶尖学校要求语数英310分+，重点学校要求290分+</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>📋 2025年十一大校录取数据参考</h2>
                    <div style="background:#fff3cd;border-left:4px solid #ffc107;padding:10px;margin:10px 0;border-radius:5px;">
                        <p><strong>💡 数据说明：</strong>以下为2024年录取分数线，2025年实际分数线可能有所调整，仅供参考。名额分配降分幅度：传统八大校20分，新增三校30分。</p>
                        <p><strong>📊 控制线变化：</strong>2024年公办普高控制线530分（比2023年下降20分），民办普高控制线约500分。考生平均分605分，普高录取率61.2%。</p>
                    </div>
                    <table class="data-table" id="dataTable">
                        </table>
                </div>

                <div class="tips">
                    <h4>💡 填报建议</h4>
                    <ul>
                        <li>第一志愿：选择与你成绩相匹配或略高的学校</li>
                        <li>保底志愿：选择录取分数线低于你成绩10-20分的学校</li>
                        <li>关注学校特色：考虑学校的特长班、实验班等</li>
                        <li>地理位置：考虑上学距离和交通便利性</li>
                        <li>多关注官方信息：及时了解最新的招生政策</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="footer">
            <p class="brand">好建议联系微信:yuyu812200</p>
            <p class="year">2025年中考填志愿建议</p>
            <p class="disclaimer">2025仅供用于学习和交流，请勿用于商业用途</p>
        </div>
    </div>

    <script>
        // 东莞中考历年数据（2025年最新）
        const examData = {
            "九年级": {
                "第二学期": {
                    "中考": { rate: 92.50, progress: -1.17, schools: ["东莞中学松山湖学校", "东莞高级中学"] },
                    "三模": { rate: 93.68, progress: -0.01, schools: ["东莞中学", "东莞第一中学"] },
                    "二模": { rate: 93.69, progress: 0.67, schools: ["东莞中学", "东莞第一中学"] },
                    "一模": { rate: 93.01, progress: 0.80, schools: ["东莞中学", "东莞外国语学校"] },
                    "月考": { rate: 92.22, progress: 1.85, schools: ["东莞中学松山湖学校", "市第六高级中学"] }
                },
                "第一学期": {
                    "期末": { rate: 90.37, progress: -0.20, schools: ["东莞外国语学校", "常平中学"] },
                    "中段考": { rate: 90.57, progress: -0.18, schools: ["东莞外国语学校", "常平中学"] },
                    "月考": { rate: 90.76, progress: 0.18, schools: ["东莞外国语学校", "常平中学"] }
                }
            }
        };

        const elevenSchools = {
            "东莞中学": { level: "顶尖", hujiScore: 736, suiqianScore: 720, rank: 1, quota: 480, features: ["百年名校", "重本率超90%", "科技创新与文化传承并重"]},
            "东莞中学松山湖学校": { level: "顶尖", hujiScore: 728, suiqianScore: 737, rank: 2, quota: 624, features: ["小班化教学", "与华为等企业合作", "特控率约90%"]},
            "松山湖未来学校": { level: "顶尖", hujiScore: 724, suiqianScore: 737, rank: 3, quota: 349, features: ["AI+教育模式", "智能化教学平台", "港澳班特色突出"]},
            "东莞市第一中学": { level: "重点", hujiScore: 717, suiqianScore: 730, rank: 4, quota: 815, features: ["艺术体育与科创教育突出", "重本率约80%", "国家级示范性高中"]},
            "东莞高级中学": { level: "重点", hujiScore: 711, suiqianScore: 724, rank: 5, quota: 573, features: ["创客教育领先", "心理健康教育特色", "本科上线率100%"]},
            "东莞实验中学": { level: "重点", hujiScore: 703, suiqianScore: 719, rank: 6, quota: 774, features: ["航空班", "学科竞赛强校", "理科竞赛成果显著"]},
            "东莞外国语学校": { level: "重点", hujiScore: 717, suiqianScore: 725, rank: 7, quota: 503, features: ["多语种课程", "国际化交流项目", "外语特色鲜明"]},
            "市第六高级中学": { level: "优质", hujiScore: 707, suiqianScore: 718, rank: 8, quota: 719, features: ["艺术教育标杆", "高考中进优出", "数理特色班成绩突出"]},
            "石龙中学": { level: "优质", hujiScore: 683, suiqianScore: 714, rank: 9, quota: 507, features: ["百年老校", "机器人项目国际获奖", "科技创新班成果显著"], isNew: true},
            "常平中学": { level: "优质", hujiScore: 675, suiqianScore: 708, rank: 10, quota: 922, features: ["集团化办学标杆", "高考600分以上人数翻倍", "科技创新与篮球特色"], isNew: true},
            "万江中学": { level: "优质", hujiScore: 674, suiqianScore: 705, rank: 11, quota: 651, features: ["食育与体育特色", "足球项目全市领先", "艺术特长生培养突出"], isNew: true}
        };
        
        // 初中学校户籍毕业生人数 (重要：请务必用最新官方数据替换这些占位符)
        // 数据来源：基于您提供的 "这些图片帮我做一个表格。1~230行。.xlsx - 这些图片帮我做一个表格。1~230行。.csv" 文件
        // 和 "微信图片编辑_20250529001618.jpg" 进行综合整理和示例填充
        const juniorHighSchoolData = {
            "东莞市东莞中学初中部": { hujiGraduates: 1002 },
            "东莞市可园中学": { hujiGraduates: 934 },
            "东莞市光明中学": { hujiGraduates: 994 },
            "东莞市石龙第二中学": { hujiGraduates: 543 },
            "东莞市虎门第三中学": { hujiGraduates: 1033 },
            "东莞市长安镇实验中学": { hujiGraduates: 1822 },
            "东莞市沙田实验中学": { hujiGraduates: 1034 },
            "东莞市济川中学": { hujiGraduates: 407 },
            "东莞市麻涌镇古梅第一中学": { hujiGraduates: 1022 },
            "东莞市万江第三中学": { hujiGraduates: 911 },
            "东莞市石碣中学": { hujiGraduates: 700 },
            "东莞市寮步中学": { hujiGraduates: 879 },
            "东莞市大朗镇第一中学": { hujiGraduates: 1035 },
            "东莞市大岭山新风中学": { hujiGraduates: 656 },
            "东莞市厚街湖景中学": { hujiGraduates: 1458 },
            "东莞市南城中学": { hujiGraduates: 1039 },
            "东莞市东城初级中学": { hujiGraduates: 1051 }, // 东城实验中学 在之前版本，这里用东城初级中学替代或合并
            "东莞市茶山中学": { hujiGraduates: 847 },
            "东莞市企石中学": { hujiGraduates: 800 },
            "东莞市石排中学": { hujiGraduates: 822 },
            "东莞市常平镇振兴中学": { hujiGraduates: 761 },
            "东莞市横沥中学": { hujiGraduates: 704 },
            "东莞市东坑中学": { hujiGraduates: 701 },
            "东莞市桥头中学": { hujiGraduates: 679 },
            "东莞市黄江中学": { hujiGraduates: 1052 },
            "东莞市樟木头中学": { hujiGraduates: 1037 },
            "东莞市谢岗中学": { hujiGraduates: 164 },
            "东莞市清溪中学": { hujiGraduates: 948 },
            "东莞市塘厦初级中学": { hujiGraduates: 1207 },
            "东莞市华侨中学": { hujiGraduates: 1148 }, // 对应凤岗片区
            "东莞市洪梅中学": { hujiGraduates: 306 },
            "东莞市松山湖实验中学": { hujiGraduates: 466 },
            "东莞市海德双语学校": { hujiGraduates: 339 }, // 用户指定添加
            "东莞市东城中学": { hujiGraduates: 976 }, // 来自之前版本，确认是否与东城初级中学合并或区分
            "东莞市莞城英文实验学校": { hujiGraduates: 300 }, // 示例数据，需确认
             // ... 其他学校来自CSV和图片，需要手动整理和去重
            "东莞市清溪三中绮丽学校": { hujiGraduates: 1 },
            "东莞市清溪晨光第一学校": { hujiGraduates: 38 },
            "东莞市清溪大立学校": { hujiGraduates: 40 },
            "东莞市清溪华晟外国语学校": { hujiGraduates: 200 },
            "东莞市众美中学": { hujiGraduates: 64 },
            "东莞市塘厦第二初级中学": { hujiGraduates: 1118 },
            "东莞市塘厦水霖学校": { hujiGraduates: 63 },
            "东莞市水霖实验学校": { hujiGraduates: 171 },
            "东莞市凤岗金凤凰学校": { hujiGraduates: 170 },
            "东莞市松山湖北区学校": { hujiGraduates: 243 },
            "东莞松山湖未来学校": { hujiGraduates: 265 }, // 注意与elevenSchools里的未来学校数据统一
            "东莞市松山湖南方外国语学校": { hujiGraduates: 101 },
            "东莞市松山湖莞美学校": { hujiGraduates: 175 },
            "东莞台商子弟学校": { hujiGraduates: 236 },
            "市体育运动学校": { hujiGraduates: 32 },
            "东莞市松山湖清澜山学校": { hujiGraduates: 15 }
        };

        // 全市户籍毕业生总人数 (重要：请务必用最新官方数据替换这个占位符)
        // 根据您提供的CSV文件表头总计，这个数字是 61024
        const totalCityHujiGraduates = 61024; 

        const otherSchools = {
            '东莞市第八高级中学': { level: '公办重点', hujiScore: 640, suiqianScore: 695, features: ['分层教学', '艺考优势', '实验班'], note: '2024年扩招爆冷，2025年缩招分数线回升', type: '公办'},
            '清溪中学': { level: '集团校', hujiScore: 637, suiqianScore: 659, features: ['东莞高级中学集团', '共享师资', '硬件完善'], note: '适合松山湖片区考生', type: '公办'},
            '东莞市第十三高级中学': { level: '集团校', hujiScore: 665, suiqianScore: 668, features: ['松山湖学校集团', '师资强劲', '本科率80%+'], note: '教学质量稳定', type: '公办'},
            '海德双语学校': { level: '民办优质', hujiScore: 625, suiqianScore: 625, features: ['C9班', '强基班', '本科率92.1%'], note: '高分段民办兜底', type: '民办'},
            '丰泰外国语实验高级中学': { level: '民办中上', hujiScore: 650, suiqianScore: 680, features: ['硬件顶配', '师资高配', '高性价比'], note: '追求性价比的选择', type: '民办'}
        };

        function populateJuniorHighSchools() {
            const selectElement = document.getElementById('juniorHighSchool');
            const sortedSchoolNames = Object.keys(juniorHighSchoolData).sort((a, b) => a.localeCompare(b, 'zh-CN'));
            
            sortedSchoolNames.forEach(schoolName => {
                const option = document.createElement('option');
                option.value = schoolName;
                option.textContent = schoolName;
                selectElement.appendChild(option);
            });
        }

        function populateHujiGraduates() {
            const selectedSchool = document.getElementById('juniorHighSchool').value;
            const hujiInput = document.getElementById('hujiGraduatesInput');
            if (selectedSchool && juniorHighSchoolData[selectedSchool]) {
                hujiInput.value = juniorHighSchoolData[selectedSchool].hujiGraduates;
                hujiInput.disabled = true; // Optional: disable if selected from dropdown
            } else {
                hujiInput.value = '';
                hujiInput.disabled = false;
            }
        }


        function analyzeScore() {
            const grade = document.getElementById('grade').value;
            const semester = document.getElementById('semester').value;
            const exam = document.getElementById('exam').value;
            const score = parseFloat(document.getElementById('score').value);
            const totalScore = parseFloat(document.getElementById('totalScore').value);
            const selectedJuniorHigh = document.getElementById('juniorHighSchool').value;
            const manualHujiGraduates = document.getElementById('hujiGraduatesInput').value;


            if (isNaN(score) || isNaN(totalScore) || score > totalScore || score < 0 || totalScore <=0) {
                alert('请输入有效的成绩和满分！');
                return;
            }
            
            let currentJuniorHighHujiGraduates = 0;
            if (selectedJuniorHigh && juniorHighSchoolData[selectedJuniorHigh]) {
                currentJuniorHighHujiGraduates = juniorHighSchoolData[selectedJuniorHigh].hujiGraduates;
            } else if (manualHujiGraduates && !isNaN(parseFloat(manualHujiGraduates)) && parseFloat(manualHujiGraduates) > 0) {
                 currentJuniorHighHujiGraduates = parseFloat(manualHujiGraduates);
            }


            const scoreRate = (score / totalScore * 100).toFixed(2);
            const data = examData[grade]?.[semester]?.[exam];

            if (!data) {
                document.getElementById('progress').textContent = 'N/A';
            } else {
                 document.getElementById('progress').textContent = data.progress > 0 ? '+' + data.progress + '%' : data.progress + '%';
            }

            document.getElementById('scoreRate').textContent = scoreRate + '%';
            
            const recommendations = getRecommendedSchools(scoreRate, selectedJuniorHigh, currentJuniorHighHujiGraduates); 
            document.getElementById('recommendCount').textContent = recommendations.first.length + recommendations.second.length + recommendations.backup.length;

            generateSchoolRecommendations(scoreRate, selectedJuniorHigh, currentJuniorHighHujiGraduates); 
            generateQuotaAnalysis(scoreRate, selectedJuniorHigh, currentJuniorHighHujiGraduates); 
            generateDataTable(grade, semester);
            document.getElementById('analysisResult').classList.add('show');
        }

        function getRecommendedSchools(scoreRate, selectedJuniorHigh, currentJuniorHighHujiGraduates) { 
            const estimatedScore = Math.round(scoreRate / 100 * 800); 
            const recommendations = { first: [], second: [], backup: [] };

            Object.entries(elevenSchools).forEach(([school, data]) => {
                const scoreDiff = estimatedScore - data.hujiScore;
                const quotaScore = data.hujiScore - (data.isNew ? 30 : 20);
                const quotaDiff = estimatedScore - quotaScore;
                
                let shouldRecommend = false;
                let probability = '冲刺';
                let reason = '';
                
                // 计算当前初中在该高中的预估分配名额
                let allocatedQuotaToThisJuniorHigh = 0;
                if (selectedJuniorHigh && currentJuniorHighHujiGraduates > 0 && totalCityHujiGraduates > 0) {
                    allocatedQuotaToThisJuniorHigh = Math.round((data.quota * (currentJuniorHighHujiGraduates / totalCityHujiGraduates)));
                }

                if (data.level === "顶尖") {
                    if (scoreDiff >= 15) { shouldRecommend = true; probability = '很高'; reason = '统招录取把握很大'; } 
                    else if (scoreDiff >= 5 && estimatedScore >= 725) { shouldRecommend = true; probability = '较高'; reason = '统招录取有较大把握'; }
                    else if (scoreDiff >= -5 && estimatedScore >= 720) { shouldRecommend = true; probability = '中等'; reason = '统招录取需要努力，可冲刺'; }
                    else if (quotaDiff >= 10 && allocatedQuotaToThisJuniorHigh > 0 && estimatedScore >= 700 ) { 
                        probability = '名额分配较高'; reason = `通过名额分配录取把握较大 (贵校名额约${allocatedQuotaToThisJuniorHigh}人)`;
                        shouldRecommend = true; 
                    } else if (quotaDiff >= 0 && allocatedQuotaToThisJuniorHigh > 0 && estimatedScore >= 690) {
                        probability = '名额分配冲刺'; reason = `通过名额分配有机会 (贵校名额约${allocatedQuotaToThisJuniorHigh}人)`;
                        shouldRecommend = true;
                    }
                } else if (data.level === "重点") {
                    if (scoreDiff >= 10) { shouldRecommend = true; probability = '很高'; reason = '统招录取把握很大'; }
                    else if (scoreDiff >= 0) { shouldRecommend = true; probability = '较高'; reason = '统招录取有较大把握'; }
                    else if (scoreDiff >= -10 && estimatedScore >= 690) { shouldRecommend = true; probability = '中等'; reason = '统招录取需要努力，可冲刺'; }
                    else if (quotaDiff >= 5 && allocatedQuotaToThisJuniorHigh > 0 && estimatedScore >= 670) { 
                        probability = '名额分配较高'; reason = `通过名额分配录取把握较大 (贵校名额约${allocatedQuotaToThisJuniorHigh}人)`;
                        shouldRecommend = true;
                    } else if (quotaDiff >= -5 && allocatedQuotaToThisJuniorHigh > 0 && estimatedScore >= 660) {
                        probability = '名额分配冲刺'; reason = `通过名额分配有机会 (贵校名额约${allocatedQuotaToThisJuniorHigh}人)`;
                        shouldRecommend = true;
                    }
                } else if (data.level === "优质") {
                    if (scoreDiff >= 5) { shouldRecommend = true; probability = '很高'; reason = '统招录取把握很大'; }
                    else if (scoreDiff >= -5) { shouldRecommend = true; probability = '较高'; reason = '统招录取有较大把握'; }
                    else if (scoreDiff >= -15 && estimatedScore >= 650) { shouldRecommend = true; probability = '中等'; reason = '统招录取需要努力，可冲刺'; }
                     else if (quotaDiff >= 0 && allocatedQuotaToThisJuniorHigh > 0) { 
                        probability = '名额分配较高'; reason = `通过名额分配录取把握较大 (贵校名额约${allocatedQuotaToThisJuniorHigh}人)`;
                        shouldRecommend = true;
                    } else if (quotaDiff >= -10 && allocatedQuotaToThisJuniorHigh > 0){
                        probability = '名额分配冲刺'; reason = `通过名额分配有机会 (贵校名额约${allocatedQuotaToThisJuniorHigh}人)`;
                        shouldRecommend = true;
                    }
                }
                
                if (shouldRecommend) {
                    recommendations.first.push({ 
                        school, 
                        probability, 
                        reason, 
                        quotaAdvantage: data.isNew ? '新增校降分30分' : '传统校降分20分', 
                        scoreDiff, 
                        quotaDiff, 
                        allocatedQuotaToThisJuniorHigh: (selectedJuniorHigh && currentJuniorHighHujiGraduates > 0) ? allocatedQuotaToThisJuniorHigh : 'N/A', // 仅在选择初中时显示具体名额
                        ...data 
                    });
                }
            });

            Object.entries(otherSchools).forEach(([school, data]) => {
                let adjustedScore = data.type === '公办' ? data.hujiScore + 5 : data.hujiScore;
                const scoreDiff = estimatedScore - adjustedScore;
                if (scoreDiff >= -15 && scoreDiff <= 35) { 
                    let probability = '冲刺';
                    if (scoreDiff >= 10) probability = '很高';
                    else if (scoreDiff >= 0) probability = '较高';
                    else if (scoreDiff >= -10) probability = '中等';
                    recommendations.second.push({ school, probability, levelDiff: data.type === '公办' ? '+5分级差' : '无级差', scoreDiff, ...data });
                }
            });

            Object.entries(otherSchools).forEach(([school, data]) => {
                const scoreDiff = estimatedScore - data.hujiScore;
                if (scoreDiff >= 10) { 
                    let safetyLevel = '安全';
                    if (scoreDiff >= 25) safetyLevel = '非常安全';
                    else if (scoreDiff >= 15) safetyLevel = '很安全';
                    recommendations.backup.push({ school, probability: '很高', safetyLevel, scoreDiff, ...data });
                }
            });

            recommendations.first.sort((a, b) => b.hujiScore - a.hujiScore);
            recommendations.second.sort((a, b) => b.hujiScore - a.hujiScore);
            recommendations.backup.sort((a, b) => b.hujiScore - a.hujiScore);
            return recommendations;
        }

        function generateSchoolRecommendations(scoreRate, selectedJuniorHigh, currentJuniorHighHujiGraduates) { 
            const recommendations = getRecommendedSchools(scoreRate, selectedJuniorHigh, currentJuniorHighHujiGraduates); 
            const estimatedScore = Math.round(scoreRate / 100 * 800); 
            let html = `<div style="background:#f8f9fa;padding:15px;border-radius:8px;margin:10px 0;"><h4 style="color:#2c3e50;margin-bottom:15px;">🎯 基于预估分数 ${estimatedScore}分 ${selectedJuniorHigh ? `(初中: ${selectedJuniorHigh})` : ''} 的志愿填报建议</h4>`;

            if (recommendations.first.length > 0) {
                html += '<div style="margin:15px 0;"><h5 style="color:#8e44ad;margin-bottom:10px;">🏆 第一志愿推荐 (名额分配优先)</h5>';
                recommendations.first.slice(0,4).forEach(rec => {
                    const probabilityColor = {'很高': '#28a745', '较高': '#17a2b8', '中等': '#ffc107', '冲刺': '#dc3545', '名额分配较高': '#17a2b8', '名额分配冲刺': '#ffc107'}[rec.probability] || '#6c757d';
                    const quotaScoreText = rec.hujiScore - (rec.isNew ? 30 : 20);
                    let quotaInfo = '';
                    if (rec.allocatedQuotaToThisJuniorHigh !== 'N/A') {
                        quotaInfo = ` | 贵校名额约${rec.allocatedQuotaToThisJuniorHigh}人`;
                    }

                    html += `
                        <div style="margin:8px 0;padding:10px;background:white;border-radius:5px;border-left:4px solid ${probabilityColor};">
                            <strong>${rec.school}</strong> <span style="color:${probabilityColor};font-weight:600;">[${rec.probability}]</span>
                            ${rec.isNew ? '<span style="background:#e74c3c;color:white;padding:2px 6px;border-radius:3px;font-size:0.8em;margin-left:5px;">新增</span>' : ''}
                            <br><small style="color:#666;">户籍线(参考)：${rec.hujiScore}分 | 名额分配线：约${quotaScoreText}分${quotaInfo}</small>
                            <br><small style="color:#2980b9;font-weight:500;">${rec.reason}</small>
                            <br><small style="color:#7f8c8d;">特色：${rec.features.slice(0,2).join('、')}</small>
                        </div>`;
                });
                html += '</div>';
            } else {
                html += `<div style="margin:15px 0;padding:15px;background:#fff3cd;border-radius:5px;border-left:4px solid #ffc107;"><h5 style="color:#856404;">🎯 第一志愿建议</h5><p style="color:#856404;margin:5px 0;">根据您当前的成绩水平，建议：</p><ul style="color:#856404;margin:5px 0;padding-left:20px;"><li>继续努力提升成绩，争取达到十一大校录取线</li><li>重点关注新增三校（石龙、万江、常平中学），竞争相对较小</li><li>若已选择初中，请参考下方“名额分配策略分析”了解具体到校名额</li></ul></div>`;
            }

            if (recommendations.second.length > 0) {
                html += '<div style="margin:15px 0;"><h5 style="color:#3498db;margin-bottom:10px;">🎯 第二志愿推荐</h5>';
                recommendations.second.slice(0,3).forEach(rec => {
                    const probabilityColor = {'很高': '#28a745', '较高': '#17a2b8', '中等': '#ffc107', '冲刺': '#dc3545'}[rec.probability];
                    const typeColor = {'公办': '#27ae60', '民办': '#e67e22', '综合': '#9b59b6'}[rec.type];
                    const adjustedScore = rec.type === '公办' ? rec.hujiScore + 5 : rec.hujiScore;
                    html += `
                        <div style="margin:8px 0;padding:10px;background:white;border-radius:5px;border-left:4px solid ${probabilityColor};">
                            <strong>${rec.school}</strong> <span style="color:${probabilityColor};font-weight:600;">[${rec.probability}]</span>
                            <span style="background:${typeColor};color:white;padding:2px 6px;border-radius:3px;font-size:0.8em;margin-left:5px;">${rec.type}</span>
                            <br><small style="color:#666;">户籍线：${rec.hujiScore}分 | 第二志愿线：约${adjustedScore}分 | ${rec.levelDiff}</small>
                            <br><small style="color:#7f8c8d;">${rec.features.slice(0,2).join('、')} | ${rec.note||''}</small>
                        </div>`;
                });
                html += '</div>';
            }

            if (recommendations.backup.length > 0) {
                html += '<div style="margin:15px 0;"><h5 style="color:#27ae60;margin-bottom:10px;">🛡️ 保底志愿推荐</h5>';
                recommendations.backup.slice(0,3).forEach(rec => {
                    const typeColor = {'公办': '#27ae60', '民办': '#e67e22', '综合': '#9b59b6'}[rec.type];
                    const safetyColor = {'非常安全': '#155724', '很安全': '#1e7e34', '安全': '#28a745'}[rec.safetyLevel];
                    html += `
                        <div style="margin:8px 0;padding:10px;background:white;border-radius:5px;border-left:4px solid ${safetyColor};">
                            <strong>${rec.school}</strong> <span style="color:${safetyColor};font-weight:600;">[${rec.safetyLevel}]</span>
                            <span style="background:${typeColor};color:white;padding:2px 6px;border-radius:3px;font-size:0.8em;margin-left:5px;">${rec.type}</span>
                            <br><small style="color:#666;">户籍线：${rec.hujiScore}分 | 安全余量：+${rec.scoreDiff}分</small>
                            <br><small style="color:#7f8c8d;">${rec.features.slice(0,2).join('、')} | ${rec.note||''}</small>
                        </div>`;
                });
                html += '</div>';
            }
            html += `<div style="background:#fff3cd;border-left:4px solid #ffc107;padding:10px;margin:15px 0;border-radius:5px;"><h6 style="color:#856404;margin-bottom:8px;">📋 志愿填报策略提示</h6><ul style="margin:5px 0;padding-left:20px;color:#856404;"><li><strong>梯度设计：</strong>第一志愿冲刺十一大校，第二志愿选择镇街重点或民办优质校，第三四志愿保底</li><li><strong>级差规则：</strong>十一大校第二志愿+15分，其他普高第二三四志愿+5分</li><li><strong>名额分配：</strong>仅限十一大校第一志愿，新增三校降分30分，传统八校降分20分</li><li><strong>风险控制：</strong>避免分数线相近学校连续填报，建议间隔10分以上</li></ul></div>`;
            html += '</div>';
            document.getElementById('schoolRecommendations').innerHTML = html;
        }

        function generateQuotaAnalysis(scoreRate, selectedJuniorHigh, currentJuniorHighHujiGraduates) {
            const container = document.getElementById('quotaAnalysis');
            const estimatedScore = Math.round(parseFloat(scoreRate) / 100 * 800); 
            
            let analysisHTML = `
                <div style="background:#f8f9fa;padding:15px;border-radius:8px;margin-bottom:15px;">
                    <h4 style="color:#2c3e50;margin-bottom:10px;">📋 名额分配政策解读</h4>
                    <p><strong>适用条件：</strong>东莞户籍考生，第一批次第一志愿填报</p>
                    <p><strong>分数要求：</strong>达到普高最低控制线（2024年为530分），但低于目标校统招线</p>
                    <p><strong>降分幅度：</strong>传统八大校降分20分，新增三校（石龙、万江、常平）降分30分</p>
                </div>
            `;

            if (selectedJuniorHigh && currentJuniorHighHujiGraduates > 0) {
                analysisHTML += `<h4 style="color:#27ae60; margin-bottom:10px;">🎯 为 ${selectedJuniorHigh} (户籍毕业生约${currentJuniorHighHujiGraduates}人) 分配到的十一大校名额预估</h4>`;
                
                if (totalCityHujiGraduates <= 0) {
                     analysisHTML += `<p style="color:red;">警告：全市户籍毕业生总人数未正确设置 (当前为 ${totalCityHujiGraduates})，无法进行精确名额分配计算。</p>`;
                } else {
                    Object.entries(elevenSchools).forEach(([highSchoolName, highSchoolData]) => {
                        const allocatedQuotaToJuniorHigh = (highSchoolData.quota * (currentJuniorHighHujiGraduates / totalCityHujiGraduates));
                        const displayQuota = Math.round(allocatedQuotaToJuniorHigh); 
                        
                        const quotaScore = highSchoolData.hujiScore - (highSchoolData.isNew ? 30 : 20);
                        const canReachQuotaScore = estimatedScore >= quotaScore;
                        const statusColor = canReachQuotaScore ? '#28a745' : '#ffc107';
                        let statusText = canReachQuotaScore ? '✅ 有较大机会通过名额分配录取' : '⚠️ 需努力达到名额分配预估线';
                        if (displayQuota === 0) {
                            statusText = '💔 预估无名额分配到贵校';
                        }


                        analysisHTML += `
                            <div style="background:${canReachQuotaScore && displayQuota > 0 ? '#d4edda' : '#fff3cd'};border-radius:8px;padding:12px;margin:10px 0;border-left:4px solid ${statusColor};">
                                <h5 style="margin:0 0 8px 0;color:#2c3e50;">
                                    ${highSchoolName} 
                                    ${highSchoolData.isNew ? '<span style="color:#e74c3c;font-size:0.8em;">🆕</span>' : ''}
                                    → ${selectedJuniorHigh}
                                </h5>
                                <p style="margin:5px 0;"><strong>预估分配到贵校名额：</strong>约 ${displayQuota} 人</p>
                                <p style="margin:5px 0;"><strong>该高中统招分数线：</strong>${highSchoolData.hujiScore}分</p>
                                <p style="margin:5px 0;"><strong>名额分配预估线：</strong>${quotaScore}分 <span style="color:#666;">(比统招线降${highSchoolData.hujiScore - quotaScore}分)</span></p>
                                <p style="margin:5px 0;color:${statusColor};"><strong>录取机会：${statusText}</strong> (您的预估分: ${estimatedScore})</p>
                            </div>
                        `;
                    });
                }

            } else {
                 analysisHTML += `
                    <div style="background:#e3f2fd;border-radius:8px;padding:15px;border-left:4px solid #2196f3;">
                        <h4 style="color:#1565c0;">💡 名额分配分析</h4>
                        <p>请在上方选择您的初中学校（或手动输入本校户籍毕业生人数），以获取更精确的名额分配到校预估。</p>
                        <p>若不选择或未输入有效人数，以下为十一大校的名额分配录取线参考（基于统招线降分）：</p>
                    </div>`;
                Object.entries(elevenSchools).forEach(([name, data]) => {
                    const quotaScore = data.hujiScore - (data.isNew ? 30 : 20);
                    const advantage = estimatedScore >= quotaScore;
                    const statusText = advantage ? '✅ 有机会通过名额分配录取' : '⚠️ 需要努力提升成绩';
                    const bgColor = advantage ? '#d4edda' : '#fff3cd';
                    
                    analysisHTML += `
                        <div style="background:${bgColor};border-radius:8px;padding:12px;margin:10px 0;border-left:4px solid ${advantage ? '#28a745' : '#ffc107'};">
                            <h5 style="margin:0 0 8px 0;color:#2c3e50;">
                                ${name} ${data.isNew ? '<span style="color:#e74c3c;font-size:0.8em;">🆕</span>' : ''}
                            </h5>
                            <p style="margin:5px 0;"><strong>统招分数线：</strong>${data.hujiScore}分</p>
                            <p style="margin:5px 0;"><strong>名额分配预估线：</strong>${quotaScore}分 <span style="color:#666;">(降${data.hujiScore - quotaScore}分)</span></p>
                            <p style="margin:5px 0;"><strong>该校名额分配总计划：</strong>${data.quota}人</p>
                            <p style="margin:5px 0;color:${advantage ? '#28a745' : '#856404'};"><strong>${statusText}</strong> (您的预估分: ${estimatedScore})</p>
                        </div>`;
                });
            }
            container.innerHTML = analysisHTML;
        }


        function generateDataTable(grade, semester) {
            const table = document.getElementById('dataTable');
            let tableHTML = `
                <thead>
                    <tr>
                        <th>学校名称</th><th>排名</th><th>户籍生分数线</th><th>随迁子女分数线</th>
                        <th>名额分配计划(总)</th><th>学校特色</th><th>热度指数</th><th>备注</th>
                    </tr>
                </thead>
                <tbody>`;
            Object.entries(elevenSchools).forEach(([school, data]) => {
                const newSchoolBadge = data.isNew ? '<span style="background:#e74c3c;color:white;padding:2px 6px;border-radius:3px;font-size:0.8em;">新增</span>' : '';
                const levelColor = {'顶尖': '#8e44ad', '重点': '#3498db', '优质': '#27ae60'}[data.level] || '#95a5a6';
                const hotIndexData = {
                    "东莞中学": { search: 38000, ratio: '5.1:1' }, "东莞中学松山湖学校": { search: 32000, ratio: '3.5:1' },
                    "松山湖未来学校": { search: 30000, ratio: '3.3:1' }, "东莞市第一中学": { search: 29000, ratio: '3.9:1' },
                    "东莞高级中学": { search: 25000, ratio: '3.3:1' }, "东莞实验中学": { search: 27000, ratio: '3.6:1' },
                    "东莞外国语学校": { search: 23000, ratio: '3.1:1' }, "市第六高级中学": { search: 20000, ratio: '2.8:1' },
                    "石龙中学": { search: 18000, ratio: '2.5:1' }, "常平中学": { search: 17000, ratio: '2.4:1' },
                    "万江中学": { search: 16000, ratio: '2.3:1' }
                };
                const hotIndex = hotIndexData[school] || { search: 15000, ratio: '2.0:1' };

                tableHTML += `
                    <tr>
                        <td><strong>${school}</strong> ${newSchoolBadge}</td>
                        <td style="text-align:center;">${data.rank}</td>
                        <td style="text-align:center;font-weight:600;color:#2c3e50;">${data.hujiScore}分</td>
                        <td style="text-align:center;color:#7f8c8d;">${data.suiqianScore}分</td>
                        <td style="text-align:center;color:#27ae60;font-weight:600;">${data.quota}人</td>
                        <td style="font-size:0.9em;">${data.features.slice(0,2).join('、')}</td>
                        <td style="text-align:center;font-size:0.85em;"><div>搜索：${hotIndex.search}</div><div style="color:#666;">报录比：${hotIndex.ratio}</div></td>
                        <td><span style="background:${levelColor};color:white;padding:2px 6px;border-radius:3px;font-size:0.8em;">${data.level}</span>
                            ${data.isNew ? '<br><small style="color:#e74c3c;">名额分配降30分</small>' : '<br><small style="color:#7f8c8d;">名额分配降20分</small>'}</td>
                    </tr>`;
            });
            tableHTML += '</tbody>';
            table.innerHTML = tableHTML;
        }
        
        function generateTimelinePlanning() {
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth() + 1; 
            const currentYear = currentDate.getFullYear();
            let timelineHTML = `<h2 style="color:#333;margin-bottom:20px;font-size:1.8em;">📅 2025中考备考时间规划</h2><div style="position:relative;">`;
            const timeline = [
                { year: 2024, monthRange: [9, 10, 11, 12], task: '政策追踪与一轮复习', desc: '关注2025中考改革方案发布，开始第一轮系统复习。', statusMonths: [9,10,11,12] },
                { year: 2025, monthRange: [1, 2], task: '一模备考与寒假巩固', desc: '第一次模拟考试，查漏补缺，寒假针对性复习。', statusMonths: [1,2] },
                { year: 2025, monthRange: [3], task: '学校调研与二轮复习', desc: '参加校园开放日，收集招生信息，开始第二轮专题复习。', statusMonths: [3] },
                { year: 2025, monthRange: [4], task: '二模冲刺与强化训练', desc: '第二次模拟考试，精准定位，进行高强度习题训练。', statusMonths: [4] },
                { year: 2025, monthRange: [5], task: '三模调整与志愿预填', desc: '最后一次模拟，调整备考策略，初步规划志愿。', statusMonths: [5] },
                { year: 2025, monthRange: [6], task: '中考冲刺与志愿填报', desc: '正式中考，发挥最佳水平，完成志愿填报。', statusMonths: [6] }
            ];
            timeline.forEach((item, index) => {
                let status = 'pending';
                if (currentYear > item.year || (currentYear === item.year && currentMonth > Math.max(...item.monthRange))) { status = 'completed'; } 
                else if (currentYear === item.year && item.monthRange.includes(currentMonth)) { status = 'active';}
                const statusColor = {'completed': '#28a745', 'active': '#007bff', 'pending': '#6c757d'}[status];
                const monthText = item.monthRange.length > 1 ? `${item.year}年${Math.min(...item.monthRange)}月-${Math.max(...item.monthRange)}月` : `${item.year}年${item.monthRange[0]}月`;
                timelineHTML += `
                    <div style="display:flex;align-items:flex-start;margin:15px 0;padding-bottom:15px;border-bottom:1px dashed #eee;">
                        <div style="width:20px;height:20px;border-radius:50%;background:${statusColor};margin-right:15px;flex-shrink:0;display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;">
                            ${status === 'completed' ? '✓' : (status === 'active' ? '●' : '○')}
                        </div>
                        <div style="flex:1;">
                            <strong style="color:${statusColor};font-size:1.1em;">${monthText}</strong>
                            <p style="margin:5px 0 3px;font-weight:bold;color:#333;">${item.task}</p>
                            <small style="color:#555;line-height:1.4;">${item.desc}</small>
                        </div>
                    </div>`;
            });
            if(timeline.length > 0) {
                 timelineHTML = timelineHTML.substring(0, timelineHTML.lastIndexOf('border-bottom:1px dashed #eee;')) + timelineHTML.substring(timelineHTML.lastIndexOf('border-bottom:1px dashed #eee;') + 'border-bottom:1px dashed #eee;'.length);
            }
            timelineHTML += `</div>`;
            const timelineSection = document.getElementById('timelinePlanningSection');
            if (timelineSection) { timelineSection.innerHTML = timelineHTML; }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            populateJuniorHighSchools(); // 页面加载时填充初中学校下拉列表
            generateTimelinePlanning(); 
        });
        
        </script>
</body>
</html>
